#include <iostream>
 #include <fstream> // allows to read and write .txt files
#include <cmath>
#include <iomanip>
#include <cstddef>
#include <csignal>
#include <cstdio>
#include <ctime> // Biblioteca tempo
#include <string>
#include <cctype>
#include <vector>
 #include <sstream>
#include <algorithm>
#include <set>

using namespace std;

//----------------------------------------------------------------------------------------------------
/**
*Class Board represents the board of the game, allowing to define the board limits, and place the disc on the column chosen with the respective player's color
*/
class Board
{
private:
	vector <char> topline; //representa a linha vazia mais baixa (para jogar nessa quando for escolhida essa coluna, para não ter de procurar nas linhas acima)
	vector <char> ColumnLegend;
	vector< vector <string> > board;
	int numL, numC;
	char emptySymbol='.'; //flexibilidade do que é considerado espaço vazio no tabuleiro.

	int numEmptyCells; //(fica - 1 a cada jogada.Ao chegar a zero, declara empate se ninguém tiver dado.)

	//Guardar linha e coluna da última jogada(procurar se há vencedor, apartir dessa posição)
	int lastLine, lastColumn;
	char LastDiscSymbol;
	//Guardar LastDiscSymbol(procurar apenas o caráter do último vencedor)

public:
	Board(int numL, int numC, char emptySymbol, int winnersequencelength);
	void SetEmptySymbol();
	int GetNumLines() const;
	int GetNumColumns() const;
	int	GetEmptySymbol() const;
	int	GetTopLineIndexAtColumn() const;
	int putDiscAtColumn() const; //numa determinada coluna
	int isFull() const; //testar se board está cheio
	int show() const; //mostrar board
	int	isThereAWinner() const; //símbolo do vencedor, e linha e coluna da última jogada.
	int wouldThererBeAWinner() const; //putDisc + winner? (p/ AI) 
				//(pode estar numa classe complementar - Classe Game : encarregar - se de ver conteúdo, verificar vencedor

	srand(unsigned(time(NULL));
};
//--------------------------------------------------------------------------------------
Board::Board(int numL, int numC, char emptySymbol, int winnersequencelength)
{
	this->numL = numL;
	this->numC = numC;
	this->emptySymbol = emptySymbol;
	this->board = vector <vector<string>>(numL, vector <string>(numC, emptySymbol));
}
//--------------------------------------------------------------------------------------
void Board::SetEmptySymbol()
{ //default empty symbol is '.'
	int choose_emptysymbol;
	cout << "Choose the empty symbol you would prefer to see: 1.'.', 2.[], 3.\n" << endl;
	cin >> choose_emptysymbol;

	switch (choose_emptysymbol)
	{
	case (1):
		emptySymbol = '.';
	case(2):
		emptySymbol = '[]';
	case(3):
		emptySymbol = '\n';
	default:
		emptySymbol = '.';
	};
}
//--------------------------------------------------------------------------------------
int Board::GetNumLines() const
{
	return this->numL;
}
//--------------------------------------------------------------------------------------
int Board::GetNumColumns() const
{
	return this->numC;
}
//--------------------------------------------------------------------------------------
int Board::GetEmptySymbol() const
{
	return this->emptySymbol;
}
//----------------------------------------------------------------------------------------------------
int Board::GetTopLineIndexAtColumn() const
{ //parameters: numC, numL, LastColumnPlayed
	//choose column, every time a play is made, we count the column it refers to
	//topline - vector<int>
	//return this-> ;
}
//-----------------------------------------------------------------------------------------------
int Board::putDiscAtColumn() const
{
	string str_column = "";
	char column = '_';

	while (true)
	{
		//ColumnLegend.back(), shows the last element of the vector
		cout << "\n" << player1.GetName() << ", choose a column(A - " << ColumnLegend.back() << ") : ";
		cin >> str_column;

		if (str_column.size() > 1) // garante que o input é somente uma letra 
			column = '_'; //pq fazer isto?
		else //caso seja só uma letra
			column = str_column[0];

		if (int(column) > int('Z')) // garante que as minúsculas sejam convertidas em maiúsculas
			column= char(int(column) - 32);

		int index = topline.at(column);

		int column_in_headl = int(ColumnLegend.back().find(column)); // determina a posição do input no headline (se não estiver, será iqual a -1)

		if (column_in_headl != -1)
		{
			player.input = column;

			if (board[0][column_in_headl] != '.')
				cout << "\nError! This column is full, choose another one.\n";
			else
			{
				return player;
				break;
			}

		}

		else
			cout << "\nError! The column has to be between A-" << ColumnLegend.back() << "." << endl;

	}
}
//-----------------------------------------------------------------------------------------------
int Board::isFull() const
{ 
}
//-----------------------------------------------------------------------------------------------
//-----------------------------------------------------------------------------------------------
class player
{
public:
	player(int player_number, string symbol, string player_type);
	void InputName();
	string GetName();
	int GetNumber();
	string GetSymbol();
	string GetColour();
	string GetPlayerType();
	void SetPlayerType(string type);

private:
	int player_number; // 1 or 2
	string name;
	string symbol; // 'X' or 'O'
	string colour; // 'red' or 'blue'
	string player_type; // "Human", "Computer_Easy", "Computer_Medium", "Computer_Hard"
	//int N_in_line
};
//----------------------------------------------------------------------------------------------------
player::player(int player_num, string symbol, string player_type)
{
	this->player_number = player_num;
	this->symbol = symbol;
	this->player_type = player_type;
	this->name = "";

	if (symbol == "X")
		this->colour = "red";
	else if (symbol == "O")
		this->colour = "blue";
}
//----------------------------------------------------------------------------------------------------
void player::InputName()
{
	if (this->player_type == "Human")
	{
		int ID = this->player_number;
		cout << "\nPlayer" << ID << ", write your name: ";
		cin >> this->name;
		cout << "\nPlayer" << ID << ":" << this->name << endl;
	}

	else
	{
		this->name = this->player_type;
		cout << "\nPlayer" << this->player_number << ":" << this->name << endl;
	}

}
//----------------------------------------------------------------------------------------------------
int player::GetNumber()
{
	return this->player_number;
}
//---------------------------------------------------------------------------------------
string player::GetColour()
{
	return this->colour;
}
//---------------------------------------------------------------------------------------
string player::GetSymbol()
{
	return this->symbol;
}
//---------------------------------------------------------------------------------------
string player::GetName()
{
	return this->name;
}
//---------------------------------------------------------------------------------------
string player::GetPlayerType()
{
	return this->player_type;
}
//---------------------------------------------------------------------------------------
void player::SetPlayerType(string type)
{
	this->player_type = type;
}
//-----------------------------------------------------------------------------------------------
player Menu(player Enemy_player)
{
	string GameMode = "";
	string PlayerVSPlayer = "1";
	string PlayerVSComputer = "2";
	string AI_Easy = "1";
	string AI_Medium = "2";
	string AI_Hard = "3";

	while (true)
	{
		cout << "How many people are playing?\n(1-Player VS Computer | 2-Player VS Player): ";
		cin >> GameMode;
		cout << endl;

		if (GameMode == PlayerVSPlayer)
		{
			Enemy_player.SetPlayerType("Computer_Easy");
			break;
		}

		else if (GameMode == PlayerVSComputer)
		{
			Enemy_player.SetPlayerType("Human");
			break;
		}

		else
			cout << "Error! You must input 1 or 2." << endl;

	}

	if (Enemy_player.GetPlayerType() != "Human")
		while (true)
		{
			cout << "How difficult do you want the game to be?\n(1-Easy | 2-Medium | 3-Hard) ";
			cin >> GameMode;

			if (GameMode == AI_Easy)
			{
				Enemy_player.SetPlayerType("Computer_Easy");
				break;
			}

			else if (GameMode == AI_Medium)
			{
				Enemy_player.SetPlayerType("Computer_Medium");
				break;
			}

			else if (GameMode == AI_Hard)
			{
				Enemy_player.SetPlayerType("Computer_Hard");
				break;
			}

			else
				cout << "Error! You must input 1 , 2 or 3." << endl;

		}

	return Enemy_player;

}
//-----------------------------------------------------------------------------------------------
void Game()
{
	player player1 = player(1, "X", "Human");
	player player2 = player(2, "O", "Human");
	player2 = Menu(player2); //Menu() - asks player game mode, name, choose board size etc 
	player1.InputName();
	player2.InputName();

}

//-----------------------------------------------------------------------------------------------
int main()
{
	Game();
	return 0;

}
